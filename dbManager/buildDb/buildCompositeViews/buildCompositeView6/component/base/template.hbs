SET search_path TO {{searchPath}};
--||--
DROP VIEW IF EXISTS {{viewName}};
--||--
CREATE VIEW {{viewName}} AS
--||--
SELECT
{{spc}}{{schemaName}}.{{tableName}}.*
{{spc}},{{schemaName}}.{{tableName}}.id AS {{tableName}}_id
{{spc}},row_to_json(composite) as composite
FROM
{{spc}}{{schemaName}}.{{tableName}}
JOIN (
{{#if selectFields}}
    {{spc}}SELECT {{selectFields}}
{{else}}
    {{spc}}SELECT {{schemaName}}.{{tableName}}.*
{{/if}}
{{#if componentResults}}
{{#each componentResults}}
{{{this}}}
{{/each}}
{{/if}}
{{spc}}FROM {{schemaName}}.{{tableName}}
) composite on composite.id = {{schemaName}}.{{tableName}}.id;
